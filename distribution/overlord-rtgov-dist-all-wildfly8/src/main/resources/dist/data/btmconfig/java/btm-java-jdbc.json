{
  "instrumentation": {
    "java.sql": {
      "description": "Java JDBC instrumentation",
      "rules": [{
        "ruleName": "Java JDBC Query Component Start",
        "interfaceName": "^java.sql.Statement",
        "methodName": "executeQuery",
        "parameterTypes": [
          "*"
        ],
        "location": "ENTRY",
        "condition": "isActive()",
        "actions": [{
          "type": "InstrumentComponent",
          "direction": "In",
          "componentTypeExpression": "\"Database\"",
          "uriExpression": "$0.getConnection().getMetaData().getURL()"
        },{
          "type": "SetDetail",
          "name": "statement",
          "valueExpression": "$0"
        },{
          "type": "SetDetail",
          "name": "action",
          "valueExpression": "\"query\""
        },{
          "type": "SetDetail",
          "name": "btm_source",
          "valueExpression": "\"java.sql\""
        },{
          "type": "Suppress"
        }]
      },{
        "ruleName": "Java JDBC Query Component End",
        "interfaceName": "^java.sql.Statement",
        "methodName": "executeQuery",
        "parameterTypes": [
          "*"
        ],
        "location": "EXIT",
        "condition": "isActive()",
        "actions": [{
          "type": "InstrumentComponent",
          "direction": "Out",
          "componentTypeExpression": "\"Database\"",
          "uriExpression": "$0.getConnection().getMetaData().getURL()"
        }]
      },{
        "ruleName": "Java JDBC Prepared Query Component Start",
        "interfaceName": "^java.sql.PreparedStatement",
        "methodName": "executeQuery",
        "parameterTypes": [
        ],
        "location": "ENTRY",
        "condition": "isActive()",
        "actions": [{
          "type": "InstrumentComponent",
          "direction": "In",
          "componentTypeExpression": "\"Database\"",
          "uriExpression": "$0.getConnection().getMetaData().getURL()"
        },{
          "type": "SetDetail",
          "name": "statement",
          "valueExpression": "$0"
        },{
          "type": "SetDetail",
          "name": "action",
          "valueExpression": "\"query\""
        },{
          "type": "SetDetail",
          "name": "btm_source",
          "valueExpression": "\"java.sql\""
        },{
          "type": "Suppress"
        }]
      },{
        "ruleName": "Java JDBC Prepared Query Component End",
        "interfaceName": "^java.sql.PreparedStatement",
        "methodName": "executeQuery",
        "parameterTypes": [
        ],
        "location": "EXIT",
        "condition": "isActive()",
        "actions": [{
          "type": "InstrumentComponent",
          "direction": "Out",
          "componentTypeExpression": "\"Database\"",
          "uriExpression": "$0.getConnection().getMetaData().getURL()"
        }]
      },{
        "ruleName": "Java JDBC Update Component Start",
        "interfaceName": "^java.sql.Statement",
        "methodName": "executeUpdate",
        "parameterTypes": [
          "*"
        ],
        "location": "ENTRY",
        "condition": "isActive()",
        "actions": [{
          "type": "InstrumentComponent",
          "direction": "In",
          "componentTypeExpression": "\"Database\"",
          "uriExpression": "$0.getConnection().getMetaData().getURL()"
        },{
          "type": "SetDetail",
          "name": "statement",
          "valueExpression": "$0"
        },{
          "type": "SetDetail",
          "name": "action",
          "valueExpression": "\"update\""
        },{
          "type": "SetDetail",
          "name": "btm_source",
          "valueExpression": "\"java.sql\""
        },{
          "type": "Suppress"
        }]
      },{
        "ruleName": "Java JDBC Update Component End",
        "interfaceName": "^java.sql.Statement",
        "methodName": "executeUpdate",
        "parameterTypes": [
          "*"
        ],
        "location": "EXIT",
        "condition": "isActive()",
        "actions": [{
          "type": "InstrumentComponent",
          "direction": "Out",
          "componentTypeExpression": "\"Database\"",
          "uriExpression": "$0.getConnection().getMetaData().getURL()"
        }]
      },{
        "ruleName": "Java JDBC Prepared Update Component Start",
        "interfaceName": "^java.sql.PreparedStatement",
        "methodName": "executeUpdate",
        "parameterTypes": [
        ],
        "location": "ENTRY",
        "condition": "isActive()",
        "actions": [{
          "type": "InstrumentComponent",
          "direction": "In",
          "componentTypeExpression": "\"Database\"",
          "uriExpression": "$0.getConnection().getMetaData().getURL()"
        },{
          "type": "SetDetail",
          "name": "statement",
          "valueExpression": "$0"
        },{
          "type": "SetDetail",
          "name": "action",
          "valueExpression": "\"update\""
        },{
          "type": "SetDetail",
          "name": "btm_source",
          "valueExpression": "\"java.sql\""
        },{
          "type": "Suppress"
        }]
      },{
        "ruleName": "Java JDBC Prepared Update Component End",
        "interfaceName": "^java.sql.PreparedStatement",
        "methodName": "executeUpdate",
        "parameterTypes": [
        ],
        "location": "EXIT",
        "condition": "isActive()",
        "actions": [{
          "type": "InstrumentComponent",
          "direction": "Out",
          "componentTypeExpression": "\"Database\"",
          "uriExpression": "$0.getConnection().getMetaData().getURL()"
        }]
      }]
    }
  }
}