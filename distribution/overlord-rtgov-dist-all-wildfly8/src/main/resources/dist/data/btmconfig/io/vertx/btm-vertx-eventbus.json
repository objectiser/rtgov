{
  "instrumentation": {
    "io.vertx.core.eventbus": {
      "description": "Vertx EventBus instrumentation",
      "rules": [{
        "ruleName": "Vertx EventBus Consumer Sync Start",
        "className": "^io.vertx.core.eventbus.impl.EventBusImpl$HandlerRegistration",
        "methodName": "handle",
        "parameterTypes": [
          "io.vertx.core.eventbus.Message"
         ],
        "location": "ENTRY",
        "condition": "$1.replyAddress() == null && !isCorrelated(\"io.vertx.core.eventbus-producer\"+$1.address()) && activate($1.address(),$1.headers().get(\"HawkularBTID\"))",
        "actions": [{
          "type": "SetName",
          "nameExpression": "$1.headers().get(\"HawkularBTName\")"
        },{
          "type": "InstrumentConsumer",
          "direction": "In",
          "endpointTypeExpression": "\"MOM\"",
          "uriExpression": "$1.address()",
          "idExpression": "$1.headers().get(\"HawkularBTID\")"
        },{
          "type": "ProcessHeaders",
          "direction": "In",
          "originalType": "io.vertx.core.MultiMap",
          "headersExpression": "$1.headers()"
        },{
          "type": "SetDetail",
          "name": "btm_source",
          "valueExpression": "\"io.vertx.core.eventbus\""
        }]
      },{
        "ruleName": "Vertx EventBus Consumer Sync End",
        "className": "^io.vertx.core.eventbus.impl.EventBusImpl$HandlerRegistration",
        "methodName": "handle",
        "parameterTypes": [
          "io.vertx.core.eventbus.Message"
         ],
        "location": "EXIT",
        "condition": "$1.replyAddress() == null && isActive()",
        "actions": [{
          "type": "InstrumentConsumer",
          "direction": "Out",
          "endpointTypeExpression": "\"MOM\""
        },{
          "type": "AssertComplete"
        }]
      },{
        "ruleName": "Vertx EventBus Consumer Async Start",
        "className": "^io.vertx.core.eventbus.impl.EventBusImpl$HandlerRegistration",
        "methodName": "handle",
        "parameterTypes": [
          "io.vertx.core.eventbus.Message"
         ],
        "location": "ENTRY",
        "condition": "$1.replyAddress() != null && activate($1.address(),$1.headers().get(\"HawkularBTID\"))",
        "actions": [{
          "type": "SetName",
          "nameExpression": "$1.headers().get(\"HawkularBTName\")"
        },{
          "type": "InstrumentConsumer",
          "direction": "In",
          "endpointTypeExpression": "\"MOM\"",
          "uriExpression": "$1.address()",
          "idExpression": "$1.headers().get(\"HawkularBTID\")"
        },{
          "type": "ProcessHeaders",
          "direction": "In",
          "originalType": "io.vertx.core.MultiMap",
          "headersExpression": "$1.headers()"
        },{
          "type": "InitiateCorrelation",
          "idExpression": "\"io.vertx.core.eventbus-consumer\"+$1.replyAddress()"
        },{
          "type": "SetDetail",
          "name": "btm_source",
          "valueExpression": "\"io.vertx.core.eventbus\""
        }]
      },{
        "ruleName": "Vertx EventBus Consumer Async End",
        "className": "^io.vertx.core.eventbus.impl.EventBusImpl",
        "methodName": "sendReply",
        "parameterTypes": [
          "*"
         ],
        "location": "ENTRY",
        "condition": "isCorrelated(\"io.vertx.core.eventbus-consumer\"+$2.address())",
        "actions": [{
          "type": "CompleteCorrelation",
          "idExpression": "\"io.vertx.core.eventbus-consumer\"+$2.address()"
        },{
          "type": "InstrumentConsumer",
          "direction": "Out",
          "endpointTypeExpression": "\"MOM\""
        },{
          "type": "AssertComplete"
        }]
      },{
        "ruleName": "Vertx EventBus Queue Producer Sync Start",
        "interfaceName": "^io.vertx.core.eventbus.EventBus",
        "methodName": "send",
        "parameterTypes": [
          "java.lang.String",
          "java.lang.Object",
          "io.vertx.core.eventbus.DeliveryOptions",
          "io.vertx.core.Handler"
         ],
        "location": "ENTRY",
        "binds": [{
          "name": "id",
          "type": "java.lang.String",
          "expression": "createUUID()"
        }],
        "condition": "$4 == null && activate($1)",
        "actions": [{
          "type": "InstrumentProducer",
          "direction": "In",
          "endpointTypeExpression": "\"MOM\"",
          "uriExpression": "$1",
          "idExpression": "id"
        },{
          "type": "ProcessHeaders",
          "direction": "In",
          "originalType": "io.vertx.core.MultiMap",
          "headersExpression": "$3.getHeaders()"
        },{
          "type": "SetDetail",
          "name": "btm_source",
          "valueExpression": "\"io.vertx.core.eventbus\""
        },{
          "type": "FreeFormAction",
          "action": "$3.addHeader(\"HawkularBTID\",id)"
        },{
          "type": "FreeFormAction",
          "action": "$3.addHeader(\"HawkularBTName\",getBusinessTransactionName())"
        }]
      },{
        "ruleName": "Vertx EventBus Queue Producer Sync End",
        "interfaceName": "^io.vertx.core.eventbus.EventBus",
        "methodName": "send",
        "parameterTypes": [
          "java.lang.String",
          "java.lang.Object",
          "io.vertx.core.eventbus.DeliveryOptions",
          "io.vertx.core.Handler"
         ],
        "location": "EXIT",
        "condition": "$4 == null && isActive()",
        "actions": [{
          "type": "InstrumentProducer",
          "direction": "Out",
          "endpointTypeExpression": "\"MOM\""
        }]
      },{
        "ruleName": "Vertx EventBus PubSub Producer Sync Start",
        "interfaceName": "^io.vertx.core.eventbus.EventBus",
        "methodName": "publish",
        "parameterTypes": [
          "java.lang.String",
          "java.lang.Object",
          "io.vertx.core.eventbus.DeliveryOptions"
         ],
        "location": "ENTRY",
        "binds": [{
          "name": "id",
          "type": "java.lang.String",
          "expression": "createUUID()"
        }],
        "condition": "activate($1)",
        "actions": [{
          "type": "InstrumentProducer",
          "direction": "In",
          "endpointTypeExpression": "\"MOM\"",
          "uriExpression": "$1",
          "idExpression": "id"
        },{
          "type": "ProcessHeaders",
          "direction": "In",
          "originalType": "io.vertx.core.MultiMap",
          "headersExpression": "$3.getHeaders()"
        },{
          "type": "SetDetail",
          "name": "btm_source",
          "valueExpression": "\"io.vertx.core.eventbus\""
        },{
          "type": "SetDetail",
          "name": "btm_publish",
          "valueExpression": "\"true\""
        },{
          "type": "FreeFormAction",
          "action": "$3.addHeader(\"HawkularBTID\",id)"
        },{
          "type": "FreeFormAction",
          "action": "$3.addHeader(\"HawkularBTName\",getBusinessTransactionName())"
        }]
      },{
        "ruleName": "Vertx EventBus PubSub Producer Sync End",
        "interfaceName": "^io.vertx.core.eventbus.EventBus",
        "methodName": "publish",
        "parameterTypes": [
          "java.lang.String",
          "java.lang.Object",
          "io.vertx.core.eventbus.DeliveryOptions"
         ],
        "location": "EXIT",
        "condition": "isActive()",
        "actions": [{
          "type": "InstrumentProducer",
          "direction": "Out",
          "endpointTypeExpression": "\"MOM\""
        }]
      },{
        "ruleName": "Vertx EventBus Producer Async Start",
        "className": "^io.vertx.core.eventbus.impl.MessageImpl",
        "methodName": "setReplyAddress",
        "parameterTypes": [
          "java.lang.String"
         ],
        "location": "ENTRY",
        "binds": [{
          "name": "id",
          "type": "java.lang.String",
          "expression": "createUUID()"
        }],
        "condition": "activate($0.address())",
        "actions": [{
          "type": "InstrumentProducer",
          "direction": "In",
          "endpointTypeExpression": "\"MOM\"",
          "uriExpression": "$0.address()",
          "idExpression": "id"
        },{
          "type": "ProcessHeaders",
          "direction": "In",
          "originalType": "io.vertx.core.MultiMap",
          "headersExpression": "$0.headers()"
        },{
          "type": "InitiateCorrelation",
          "idExpression": "\"io.vertx.core.eventbus-producer\"+$1"
        },{
          "type": "SetDetail",
          "name": "btm_source",
          "valueExpression": "\"io.vertx.core.eventbus\""
        },{
          "type": "FreeFormAction",
          "action": "$0.headers().set(\"HawkularBTID\",id)"
        },{
          "type": "FreeFormAction",
          "action": "$0.headers().set(\"HawkularBTName\",getBusinessTransactionName())"
        }]
      },{
        "ruleName": "Vertx EventBus Producer Async End",
        "className": "^io.vertx.core.eventbus.impl.EventBusImpl$HandlerRegistration",
        "methodName": "handle",
        "parameterTypes": [
          "io.vertx.core.eventbus.Message"
         ],
        "location": "ENTRY",
        "condition": "isCorrelated(\"io.vertx.core.eventbus-producer\"+$1.address())",
        "actions": [{
          "type": "CompleteCorrelation",
          "idExpression": "\"io.vertx.core.eventbus-producer\"+$1.address()"
        },{
          "type": "InstrumentProducer",
          "direction": "Out",
          "endpointTypeExpression": "\"HTTP\""
        }]
      },{
        "ruleName": "Vertx EventBus Producer/Consumer Async Handler Thread Complete",
        "className": "^io.vertx.core.eventbus.impl.EventBusImpl$HandlerRegistration",
        "methodName": "handle",
        "parameterTypes": [
          "io.vertx.core.eventbus.Message"
         ],
        "location": "EXIT",
        "condition": "isActive()",
        "actions": [{
          "type": "Unlink"
        }]
      }]
    }
  }
}